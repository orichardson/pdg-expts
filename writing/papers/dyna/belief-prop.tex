\documentclass[dyna.tex]{subfiles}


\begin{document}

% \newpage

\subsection{The Sum-Product Algorithm}

\begin{defn}[Belief Propogation]
    The messages passed are given by:
    \begin{align*}
        n_{i \sto a}(x_i) &:= \prod_{c \in \partial a\setminus i} m_{c\sto i} (x_i)  
            \qquad &
        m_{a \sto i}(x) &:= \sum_{\mat X_{a} \setminus x_i} f_a(\mat x_a) \prod_{j \in \partial a \setminus i} n_{j \sto a} (x_j) 
        \end{align*}

        \begin{quotation}\it
            The message sent from a vertex $v$ on an edge $e$ is the product of the local function at $v$, with all messages recieved at $v$ (other than from $e$), 
            summarized for $e$'s variable node. \cite{kschischang2001sumproduct}
        \end{quotation}
        
        The variable beliefs, a function of the messages, are given by
        \[
            b_X(x) \propto \prod_f m_{f\sto X}(x) 
            \]
\end{defn}

\begin{question}
    Is it possible to recover the messages from the node and variable beliefs, and simply keep the relevant marginals $\tau$? If so, the PDG approach seems to make more sense. 
\end{question}



\begin{defn}
    Given a (directed) hypergraph $\mathcal G$, 
    let $\QC (\mathcal G) := \prod_{\ed LXY} (\Delta Y)^X$ be the set of possible quantitative PDGs with the qualitative structure of $\mathcal G$, i.e., all joint collections of cpds for the edges of $\mathcal G$. 
\end{defn}

\begin{defn}[Local Polytope $\mathbb L(\dg M)$]
    The local polytope $\mathbb L(\mathcal G) \subseteq \QC(\mathcal G)$ of a directed hypergraph $\mathcal G = (\N, \Ed)$, is a set of locally consistent marginals $\tau \in \QC(\mathcal G)$, given by
    % for every $e, f \in \Ed$, with $\src e = \src f =: \mat S$, and $\tgt e \subseteq \tgt f$, $\tau_e(\tgt e \mid \mat S) =  \sum_{y \in \V(\tgt f  \setminus \tgt e)} \tau_f(\tgt e, y \mid \mat S)$.
    \begin{equation}
        \begin{split}
            \mathbb L(\dg M) := \Big\{ \tau \in \QC(\mathcal G)
                ~\Big|~ \forall e, f \in \Ed.~~(\src e = \src f)\land(\tgt e \subset \tgt f) \\ 
                    ~\implies~ \tau_e(\tgt e \mid \mat S) =  \sum_{y \in \V(\tgt f  \setminus \tgt e)} \tau_f(\tgt e, y \mid \mat S)  \Big\}                
        \end{split}
\end{equation}
    
\end{defn}

\begin{defn}[Bethe Entropy]
    For a graph $G$, the $G$-Bethe entropy can be comptued just from the marginals
    of the distribution on the given edges and variables.  
    \begin{equation}
        \H_{\mathrm{Bethe}}(\tau) := \sum_{X \in \N} \H_{\tau_X}(X) - \sum_{X,Y \in G} \I_{\tau_{X,Y}}(X; Y) 
    \end{equation}
\end{defn}

\begin{defn}[Bethe Variational Problem]
    \begin{equation}
        \mathop{\mathrm{BVP}}(\theta) := \max_{\tau \in \mathbb L(G)} 
            \Big\{ \langle \theta, \tau\rangle - \H_{\mathrm{Bethe}}(\tau)\Big\}
    \end{equation}
\end{defn}

In the BVP, we fix the parameters $\theta$ (i.e., the confidences of the factor graph),
and use them to generate energies, as follows. If $\tau_X$ is a variable 

\begin{defn}

    The Lagrangian $\mathcal L$ of the with respect to the simplex constraint parameters $\Lambda : (\V(X\times Y) \to )$, is given by
    \begin{equation}
        \mathcal L(\mu, \lambda) := \bbr{\dg M} + \sum
    \end{equation}
\end{defn}

\begin{theorem}[Sum Product and Bethe problem
                     \cite{wainwright2008graphical}]
    The message $m_{i \sto a}$ is equal to the appropriate gradient of the Lagrangian function, with resect to the appropriate boundary conditions of the simplex constraint parameters. 
    \[ \grad_\lambda \mathcal L(\tau, \lambda) :=
        \sum_{ } \]  
    \TODO
\end{theorem}


% \bibliography{../,,.joe.bib,../}

\end{document}
