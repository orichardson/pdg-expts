\documentclass{article}

%%% flags
\newif\ifbiblatex
    % \biblatextrue % use the more modern & extensible biblatex+biber for bibliography.
    \biblatexfalse % use BibTeX instead.  ICML .bib file works better here.
    
\newif\ifvfull
    % \vfulltrue % longer version of the paper
    \vfullfalse % shorter conference version of the paper

\usepackage{microtype}

\input{inference-preamble.tex}
% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}
\usepackage{icml2023}

\renewcommand\ttdefault{cmvtt} % selects CM typewriter proportional font
% \renewcommand\sfdefault{cmvsf} % selects CM typewriter proportional font

% Todonotes is useful during development; simply uncomment the next line
%    and comment out the line below the next line to turn off comments
\usepackage[disable,textsize=tiny]{todonotes}
% \usepackage[textsize=tiny]{todonotes}
% \usepackage[normalem]{ulem}

\newcommand\discard[1]{}

\newcommand\obslimit{observational facet} %(distribution)
\newcommand\ObsLimit{Observational Facet} %(distribution)
% depiction / manifestiation / materialization / portrayal / image / expression / delegate / aspect / facet / form / representative / intermediary / surrogate / proxy
\newcommand\zogamma{{\bar\gamma}}

\colorlet{mayyybe}{blue!50!red!20!white}
\colorlet{rewrite}{purple!80!black}

\colorlet{olicolor}{blue!50!red!70!black}
\colorlet{joecolor}{green!50!blue!70!black}

\newcommand\vjoe[1]{{\color{joecolor}\textbf{$\boldsymbol\{$Joe: }#1 \textbf{$\boldsymbol\}$}}} 
\newcommand\voli[1]{{\color{olicolor}\textbf{$\boldsymbol\{$Oli: }#1 \textbf{$\boldsymbol\}$}}}
\newcommand\otodo[2][]{\todo[color=olicolor!30!white,#1]{#2}}


\icmltitlerunning{Inference for PDGs, via Exponential Conic Programs}
% \author{$\{$Oliver E Richardson, Joseph Y Halpern, Christopher De Sa$\}$}

\begin{document}

\twocolumn[
\icmltitle{%          
% Inference in Probabilistic Dependency Graphs,\\ via Exponential Conic Programming
%joe5: I find the title clunky (and "via" is the wrong word in any case case).
% Inference for Probabilisitic Dependency Graphs
%oli5: Since the entire technical content is reducing to exponential conic programs, It would be much more descriptive to mention it in the title. Also, it might attract people who are looking for applications of conic exponential programming, and currently nobody uses PDGs, so it might expand the audience.
%oli5: Some more reasons I prefer the longer title: I think what we have is too narrow; I'd be happy to write a paper like that, but it's not this one. I have some ideas for some other ways to do inference, like variants of message passing algorithms. And at a high level, there are other inference tasks and notions of approximate inference, and other ways of conceptualizing it that didn't make it into this paper. 
Inference for Probabilistic Dependency Graphs %,  \\
%oli5: Are you sure via is wrong? We mean "by way of" or "by reduction to". "with" and "using" seem not quite right.
% via Exponential Conic Programming%
% by way of Exponential Conic Programming%
% with Exponential Conic Programming%
% using Exponential Conic Programming%
}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2023
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.
\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Firstname1 Lastname1}{equal,yyy}
\icmlauthor{Firstname2 Lastname2}{equal,yyy,comp}
\icmlauthor{Firstname3 Lastname3}{comp}
\icmlauthor{Firstname4 Lastname4}{sch}
\icmlauthor{Firstname5 Lastname5}{yyy}
\icmlauthor{Firstname6 Lastname6}{sch,yyy,comp}
\icmlauthor{Firstname7 Lastname7}{comp}
%\icmlauthor{}{sch}
\icmlauthor{Firstname8 Lastname8}{sch}
\icmlauthor{Firstname8 Lastname8}{yyy,comp}
%\icmlauthor{}{sch}
%\icmlauthor{}{sch}
\end{icmlauthorlist}

\icmlaffiliation{yyy}{Department of XXX, University of YYY, Location, Country}
\icmlaffiliation{comp}{Company Name, Location, Country}
\icmlaffiliation{sch}{School of ZZZ, Institute of WWW, Location, Country}

\icmlcorrespondingauthor{Firstname1 Lastname1}{first1.last1@xxx.edu}
\icmlcorrespondingauthor{Firstname2 Lastname2}{first2.last2@www.uk}

% You may provide any keywords that you
% find helpful for describing your paper; these are used to populate
% the "keywords" metadata in the PDF but will not be shown in the document
\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
\printAffiliationsAndNotice{\icmlEqualContribution} % otherwise use the standard text.

% \twocolumn[
% 
% %joe1: I would cut the second part of the title
% %  \aistatstitle{Inference in Probabilistic Dependency Graphs,\\
%   %    via Exponential Cones and Otherwise}
%   %oli3:
%     % \aistatstitle{Inference in Probabilistic Dependency Graphs}
%     \aistatstitle{
%         }
% 
% %joe1: initials need periods
%     %\aistatsauthor{ Oliver E Richardson \And Joseph Y Halpern \And
%     \aistatsauthor{ Oliver E. Richardson \And Joseph Y. Halpern \And
%   Christopher De Sa }
% % \aistatsaddress{ Institution 1 \And  Institution 2 \And Institution 3 }
% \aistatsaddress{Cornell University \And Cornell University \And Cornell University}
% ]

\begin{abstract}
%joe4: you need to tell the rader what PDGs are; I pulled the first sentence from the intro
%joe5
  %  Probabilistic Dependency Graphs (PDGs)
\emph{Probabilistic dependency graphs (PDGs)}
%oli4: would prefer to avoid the citation in the abstract
% \parencite{pdg-aaai}
are a flexible class of probabilistic graphical models,
%joe4: subsumes -> subsume
%oli4: the subject is "a class" (singular), so I still think "subsumes" is correct?
%oli4: it looks slightly wrong to me either way. I think this is becaus of the phrase
%   " PDGs (plural) are (plural) a class (singular) ... "
% We could do "PDGs *form* a class ... which subsumes"
% ... or  "PDGs are flexible graphical models ... which subsume" ?
%which subsumes Bayesian Networks and Factor Graphs.
%joe5: this avoids the problem
% They subsume Bayesian Networks and Factor Graphs.
%oli5: it's also really choppy with two short sentences next to each other that have the same point. What about:
subsuming Bayesian Networks and Factor Graphs.
% which subsume Bayesian Networks and Factor Graphs.
%oli4:
% They can also capture inconsistent beliefs, and the degree of this inconsistency can be measured canonically.
%joe5: we are not mesauring the inconsistency of a PDG, and I see
%nothing canonical about our approach.
%oli5: I wasn't not referring to the incompatibility of a probability distribution with the PDG; I'm referring to the degree of inconsistency of the PDG, which is conceptually more straightforward (if mathematically more complex).  Perhaps this measure is not the only one worth entertaining, but it has special properties.
%oli5: perhaps natural is up for debate, but it is canonical by definition: it's how we set up the model in the last two papers (the canon), and essentially all results about PDGs are predicated on this decisision.  
% They can also capture inconsistent beliefs; moreover, we can measure how
% inconsistent a probability distribution is with a PDG.  
%joe6: I don't find it so natural.  I just cut "natural"
%oli6: ok.  I'll convince you sooner or later. 
They can also capture inconsistent beliefs, and provide a way of measuring the degree of this inconsistency.
% A PDG can contain inconsistent beliefs, and there is a natural way measuring its degree of inconsistency.
%
We provide the first tractable inference algorithm for
% Probabilistic Dependency Graphs (PDGs)
PDGs with discrete variables,
%oli4: now that we have the new sentence, we can simplify this:
% thereby placing PDGs on asymptotically similar footing as other graphical models,
% such as Bayesian Networks and Factor Graphs, despite the fact that PDGs are more expressive.
%joe6: I find this clunky.  More importantly, what does
%"asymptotically" mean in this context.  It doesn't seem correct
%thereby placing PDGs on asymptotically similar footing as the
making the complexity of inference for PDGs asymptotically comparable to that of the
graphical models they generalize. 
%joe5: (2) and (3) seem to be saying ore or less the same thing.  I prefer the earlier approach that combined them
%(2) that this can be done efficiently for PDGs of bounded tree-width, and
%(3) the recent development of interior-point methods
% that can solve such problems efficiently (Dahl \& Anderson, 2022).
%oli5: Hmm, I'm trying to make two very distinct points.  Point (2) is the clever contructions done in section 5 to show polynomial size of  the problem for bounded tree width, while point (3) is prior work on solving these problems in polynomial time. Point (2) is more important and has been erased with your re-write.
% (2) the recent development of interior-point methods that can solve
% the exponential cones programs that arise for PDGs of bounded tree
% width efficiently.
% The key components of our approach are
% (1) the observation that inference in PDGs can be reduced to a convex optimization problem with exponential cone constraints, 
% efficiently so for PDGs of bounded tree-width, and 
% %oli6: after revisiting the literature, it's not worth emphasizing the recency.
% (2) the recent development
% of interior-point methods
%  that can solve such problems efficiently.
% We evaluate our approach by ...
The key components are
% of our approach are
(1) the observation that PDG inference can be reduced to convex optimization with exponential cone constraints, 
(2) a construction that allows us to express these problems compactly for PDGs of boundeed treewidth, for which we needed to further develop the theory of PDGs, and
(3) an appeal to interior point methods that can solve such problems in polynomial time.
We verify the correctness and complexity of our approach, provide an implementation, and a cursory analysis. 
\end{abstract}


% \begin{narrow}
% %%-----------    A FRANK SUMMARY    ---------------
% Measuring / Estimating /  Inconsistency is very useful.
% For instance, (1) propagating it backwards through layers of computation = differentiable learning.
%
% Certain localized versions of it can be used to do other algorithms.

% How hard is it?
% With interior point methods (convex programs with exponential cone constraints) we can do it in $O(n^4 \log n)$ time \& space, worst case for exact inference. So far, this means slightly harder than inference in Graphical models.
% \end{narrow}


% \tableofcontents

\input{inference-paper-body.tex}
% \subsubsection*{Acknowledgements} hello
% All acknowledgments go at the end of the paper, including thanks to reviewers who gave useful comments, to colleagues who contributed to the ideas, and to funding agencies and corporate sponsors that provided financial support.
% To preserve the anonymity, please include acknowledgments \emph{only} in the camera-ready papers.

\section*{Acknowledgements}

% \textbf{Do not} include acknowledgements in the initial version of
% the paper submitted for blind review.
% 
% If a paper is accepted, the final camera-ready version can (and
% probably should) include acknowledgements. In this case, please
% place such acknowledgements in an unnumbered section at the
% end of the paper. Typically, this will include thanks to reviewers
% who gave useful comments, to colleagues who contributed to the ideas,
% and to funding agencies and corporate sponsors that provided financial
% support.

\ifbiblatex
    \subsubsection*{References}
    \printbibliography
\else
%joe7: you need to fix the author in the MOSEK refeference
    % \bibliographystyle{apalike}
    \bibliographystyle{icml2023}
    \bibliography{refs}\fi


\clearpage
\onecolumn
\appendix

\input{appendix.tex}
\end{document}
