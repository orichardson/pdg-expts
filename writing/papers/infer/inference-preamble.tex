%% TODO make pdg.sty file that allows you to import all PDG macros.
%%%%%%%%%%


\relax % Writing Tools
    \newcommand{\TODO}[1][INCOMPLETE]{{\color{red}\hangindent=0.5cm\rightskip=0.8cm$\smash{\Big\langle}$~\texttt{#1}~\raisebox{-0.3ex}{${\Big\rangle}$}\hspace{-1.5cm}\par}}


\relax
	\DeclareMathOperator*{\argmin}{arg\,min}
	\newcommand{\bundle}{\mathbin{+}}
    \newcommand{\Rext}{\mskip1mu\overline{\mskip-1mu\mathbb R\!}\,}

\relax
    %% Narrowing
    \usepackage{keyval}
    \makeatletter
    \define@key{setpar}{left}[0pt]{\leftmargin=#1}
    \define@key{setpar}{right}[0pt]{\rightmargin=#1}
    \define@key{setpar}{both}{\leftmargin=#1\relax\rightmargin=#1}
    \makeatother

    \newenvironment{narrow}[1][]
      {\list{}{\setkeys{setpar}{left,right}%
         \setkeys{setpar}{#1}%
         \listparindent=\parindent
         \topsep=0pt
         \partopsep=0pt
         \parsep=\parskip}\item\relax\hspace*{\listparindent}\ignorespaces}
      {\endlist}
    % \newenvironment{abstract}
    %     {\narrow[both=1in]\small}         
    %     {\endnarrow}


\relax % Bibliography
    \usepackage[backend=biber, style=authoryear]{biblatex}
    % \usepackage[backend=biber,style=authoryear,hyperref=true]{biblatex}
    \addbibresource{refs.bib}

    \DeclareLanguageMapping{american}{american-apa}
    % \renewcommand*{\nameyeardelim}{\addcomma\space}
    \DeclareDelimFormat{nameyeardelim}{\addcomma\space}
    % \listfiles

    \DeclareFieldFormat{citehyperref}{%
      \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
      \bibhyperref{#1}}

    \DeclareFieldFormat{textcitehyperref}{%
      \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
      \bibhyperref{%
        #1%
        \ifbool{cbx:parens}
          {\bibcloseparen\global\boolfalse{cbx:parens}}
          {}}}

    \savebibmacro{cite}
    \savebibmacro{textcite}

    \renewbibmacro*{cite}{%
      \printtext[citehyperref]{%
        \restorebibmacro{cite}%
        \usebibmacro{cite}}}

    \renewbibmacro*{textcite}{%
      \ifboolexpr{
        ( not test {\iffieldundef{prenote}} and
          test {\ifnumequal{\value{citecount}}{1}} )
        or
        ( not test {\iffieldundef{postnote}} and
          test {\ifnumequal{\value{citecount}}{\value{citetotal}}} )
      }
        {\DeclareFieldAlias{textcitehyperref}{noformat}}
        {}%
      \printtext[textcitehyperref]{%
        \restorebibmacro{textcite}%
        \usebibmacro{textcite}}}
