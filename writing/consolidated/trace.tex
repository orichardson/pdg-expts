\documentclass[the-pdg-manual.tex]{subfiles}
\begin{document}
	\section{Trace Semantics}
	Let $d$ be a distribution over $\Ed^{\dg M}$. 
	Choose a link $\ed LXY \in \Ed$, and let $\mathbf Z_L := \N^\dg M \setminus \{X, Y\}$ be the set of all other variables, so that a joint setting is characterized by a value $(x,y,\mat z)$.
	
	The link $L$ and its associated cpt $\bp$ can be extended to a transformer $\tau_L: \Delta \V(\dg M) \to \Delta \V(\dg M)$ on joint distributions in a couple of ways, such as:
\[
	\begin{aligned}
		\tau(\mu)(x,y,\mat z) :&= \mu(x,y,\mat z)\frac{\bp(y \mid x)}{\mu(y\mid x)} \\
		&= \mu(x)\; \bp(y \mid x)\; \mu(\mat z \mid x,y) 
	\end{aligned}\qquad\text{and}\qquad
	\begin{aligned}
		\tau(\mu)(x,y,\mat z) :&= \mu(x,y,\mat z) \frac{\bp(y \mid x)}{\mu(y\mid x, \mathbf z)} \\
		&= \mu(x,\mat z)\; \bp(y \mid x)
	\end{aligned}\\
\]
	
\subsection{Traces of a PDG}
The arrows of a PDG are cpds, which are probabilistic functions, and can be composed to form further probabilistic functions. 


\begin{defn}
	A \emph{schedule} $\mathbf s : \Delta[\mathbb N \to \Ed^{\dg M}]$ for a PDG $\dg M$ is distribution over sequences of $\dg M$'s edges. 
\end{defn}
\begin{defn}
   The \emph{trace distribution} of a PDG is the distribution or outputs represented by the program \texttt{trace}$_{\dg M}$
   % \begin{algorithmic}
   % 	 % TODO
   % 	\end{algorithmic}

\end{defn}
\begin{defn}[trace semantics]
	For a PDG $\dg M$ and schedule $\mathbf s$ for $\dg M$, the trace semantics is a distribution
	over the $\sigma$-algebra  whose 
	\[ \mathbb{T}_{\bf s}{\dg M} = 
		% \Big\{ 
		% \Big\}
	 \]
\end{defn}

Check: trace semantics is probably different for a PDH $\dg H$ and its corresponding PDG $\dg M$.
Perhaps this will not be the case if we define the trace semantics differently? 


\begin{defn}[composition]
	If $\ed fAB$ and $\ed gBC$ are edges of a PDG, we can compose the them to give a directed edge
	$\ed{g\circ f}AB$ whose  by matrix composition. Concretely, 
	\begin{inactive}
	\begin{align*}
		\bp[g\circ f] &:= a \mapsto \sum_{b \in \V(B)} \bp[f](b\mid a)\bp[g](c \mid b) \\
		\beta_{g \circ f} &:= \beta_g \beta_f ??
	\end{align*}
	\end{inactive}
\end{defn}
\begin{defn}
	If $\dg M$ is a PDG, let $\dg M^*$ be the limiting
\end{defn}
\end{document}
