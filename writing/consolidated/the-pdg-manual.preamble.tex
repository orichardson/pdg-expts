%% BIBLIO
\usepackage{natbib}


%% STANDARD PACKAGES
\usepackage{mathtools}		%also loads amsmath
\usepackage{amssymb, bbm}
\usepackage{booktabs}
\usepackage{nicefrac}
\usepackage{algpseudocode}
\usepackage[dvipsnames, cmyk]{xcolor} % must be loaded before tikz
\usepackage{tikz} % setup comes later
\usepackage{enumitem}
\usepackage{array} 
\newcolumntype{L}{>{$}l<{$}} % switch mathmode, a description column
% \usepackage{trimclip}
\usepackage{xstring}
\usepackage{environ}% http://ctan.org/pkg/environ;
	% required for use of label_matrix.tex.
\usepackage{nameref,hyperref}%\Autoref is defined by thmtools

\usepackage[noabbrev,nameinlink,capitalize]{cleveref}% n.b. cleveref after! hyperref
\crefname{example}{Example}{Examples}
\crefname{defn}{Definition}{Definitions}
\crefname{prop}{Proposition}{Propositions}
\crefname{constr}{Construction}{Constructions}
\crefname{conj}{Conjecture}{Conjectures}
\crefname{fact}{Fact}{Facts}


% visual appearance
\colorlet{color1}{Emerald}
\colorlet{color2}{color1>wheel,1,3}
\colorlet{color3}{color1>wheel,2,3}
\definecolor{deepgreen}{rgb}{0,0.5,0}
\colorlet{pinkish}{color3!25!magenta}
\usepackage{relsize}
% \hypersetup{colorlinks=true, linkcolor=blue, urlcolor=magenta, citecolor=deepgreen}
\hypersetup{colorlinks=true, linkcolor=color1, urlcolor=magenta, citecolor=color2}
\usepackage{parskip}
\usepackage{microtype}      % microtypography
\usepackage[format=plain,labelfont={sl},textfont={it,small},margin=1cm]{caption}
\usepackage{subcaption}
%\usepackage{subfig}
%\captionsetup[subfigure]{subrefformat=simple,labelformat=simple}
%\renewcommand\thesubfigure{(\alph{subfigure})}


% PREPARING EXTRA SYMBOLS
\usepackage{stmaryrd} % disable me for Joe
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}
\makeatletter 
% load lBrace, rBrace from stix... but don't load stix
\@ifpackageloaded{stix}{}{
	\DeclareFontEncoding{LS2}{}{\noaccents@} \DeclareFontSubstitution{LS2}{stix}{m}{n}
	\DeclareSymbolFont{stix@largesymbols}{LS2}{stixex}{m}{n}
	\SetSymbolFont{stix@largesymbols}{bold}{LS2}{stixex}{b}{n}
	\DeclareMathDelimiter{\lBrace}{\mathopen} {stix@largesymbols}{"E8}{stix@largesymbols}{"0E}
	\DeclareMathDelimiter{\rBrace}{\mathclose}{stix@largesymbols}{"E9}{stix@largesymbols}{"0F}
}
% who doesn't love dutchcal?
\DeclareMathAlphabet{\mathdcal}{U}{dutchcal}{m}{n} 
\DeclareMathAlphabet{\mathbdcal}{U}{dutchcal}{b}{n}
\DeclareRobustCommand{\shortto}{\mathrel{\mathpalette\short@to\relax}}
\newcommand{\short@to}[2]{%
	\mkern2mu
	\clipbox{{.5\width} 0 0 0}{$\m@th#1\vphantom{+}{\shortrightarrow}$}%
}
% better-spaced cases environment
\makeatletter
\renewenvironment{cases}[1][l]{\matrix@check\cases\env@cases{#1}}{\endarray\right.}
\def\env@cases#1{%
	\let\@ifnextchar\new@ifnextchar
	\left\lbrace\def\arraystretch{1.2}%
	\array{@{}#1@{\quad}l@{}}}
\makeatother
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\makeatother


% GENERAL SYMBOLS
\let\Horig\H
\let\H\relax
\def\nf{\nicefrac}
\DeclareMathOperator{\H}{\mathrm{H}} % Entropy
\DeclareMathOperator{\I}{\mathrm{I}} % Information
\DeclareMathOperator*{\Ex}{\mathbb{E}} % Expectation
\DeclareMathOperator*{\argmin}{arg\;min}
\newcommand\At[1]{\mathit{A\mkern-2mu t}(#1)} % boolean algebra atoms
\newcommand\lang[1]{\mathcal L^{\mathit{#1}}} % languages
\newcommand\geqc{\succcurlyeq}
\newcommand\leqc{\preccurlyeq}
\newcommand\mat[1]{\mathbf #1}
\newcommand{\tto}{\rightarrow\mathrel{\mspace{-15mu}}\rightarrow}
\newcommand{\indi}[1]{\mathbbm{1}_{\left[\vphantom{\big[}#1 \vphantom{\big]}\right]}}
\newcommand{\CI}{\mathrel{\perp\mspace{-10mu}\perp}}

\DeclarePairedDelimiterX{\infdivx}[2]{(}{)}{#1\;\delimsize\|\;#2}
\newcommand{\thickD}{I\mkern-8muD}
\newcommand{\kldiv}{\thickD\infdivx} % D_\mathrm{KL}

\DeclarePairedDelimiter{\cbbr}{\lBrace}{\rBrace}
\DeclarePairedDelimiter{\bbr}{\llbracket}{\rrbracket}
\DeclarePairedDelimiter{\ppr}{\llparenthesis}{\rrparenthesis}


% SPACES
\newcommand\Set{\mathbb{S}\mathrm{et}}
\newcommand\FinSet{\mathbb{F}\mathrm{in}\mathrm{S}\mathrm{et}}
\newcommand\Meas{\mathbb{M}\mathrm{eas}}
\newcommand\two{\mathbbm 2}
\newcommand\PDG{\mathbb{P}\mathrm{DG}}


% PDG SYMBOLS
\newcommand{\N}{\mathcal N}
\newcommand{\Ed}{\mathcal E}
\newcommand{\V}{\mathcal V}
\newcommand{\bp}[1][L]{\mathbf{p}_{\!_{#1}\!}}

\newcommand{\Gr}{\mathcal G}
\newcommand\src{\mathbf{src}}
\newcommand\tgt{\mathbf{tgt}}
\newcommand{\qq}{\triangleright}

\newcommand{\dg}[1]{\mathbdcal{#1}}
\newcommand{\var}[1]{\mathsf{#1}}
\newcommand{\none}{\varobslash}
\newcommand{\ed}[3]{%
	\mathchoice%
	{#2\overset{\smash{\mskip-5mu\raisebox{-3pt}{${#1}$}}}{\xrightarrow{\hphantom{\scriptstyle {#1}}}} #3} %display style
	{#2\overset{\smash{\mskip-5mu\raisebox{-3pt}{$\scriptstyle {#1}$}}}{\xrightarrow{\hphantom{\scriptstyle {#1}}}} #3}% text style
	{#2\overset{\smash{\mskip-5mu\raisebox{-3pt}{$\scriptscriptstyle {#1}$}}}{\xrightarrow{\hphantom{\scriptscriptstyle {#1}}}} #3} %script style
	{#2\overset{\smash{\mskip-5mu\raisebox{-3pt}{$\scriptscriptstyle {#1}$}}}{\xrightarrow{\hphantom{\scriptscriptstyle {#1}}}} #3}} %scriptscriptstyle

	
\newcommand{\alle}[1][L]{_{\ed {#1}XY}}

\DeclareMathOperator\dcap{\mathop{\dot\cap}}
\newcommand\Inc{\mathit{Inc}}
\newcommand{\IDef}[1]{\mathit{IDef}_{#1}}

% conversions
%\newcommand{\PDGof}[1]{{\dg M}_{#1}}
\makeatletter
\newcommand{\PDGof}[1]{{\mathbdcal{p\kern-0.05em d\kern-0.125em g}} \ifx#1\@empty\else(#1)\fi}
\newcommand{\PDHof}[1]{{\mathbdcal{p\kern-0.05em d\kern-0.125em h}} \ifx#1\@empty\else(#1)\fi}

% \newcommand{\UPDGof}[1]{{\dg N}_{#1}}
\newcommand{\UPDGof}[1]{{\mathbdcal{u\kern-0.05em p\kern-0.05em d\kern-0.125em g}} \ifx#1\@empty\else(#1)\fi}
\makeatother

% \DeclarePairedDelimiter{\SD}{\llbracket}{\rrbracket_{\text{sd}}
% \DeclarePairedDelimiterXPP{\SD}[1]{}{\llbracket}{\rrbracket}{_{\text{sd}}}{#1}
% \DeclarePairedDelimiterX{\SD}[1]{\{}{\}}{\delimsize\{#1\delimsize\}}
\DeclarePairedDelimiterX{\SD}[1]{\{}{\}}{\,\llap{\delimsize\{}#1\rlap{\delimsize\}}\,}
% \def\SD{\cbbr}


%% OTHER PGM SYMBOLS
\newcommand\GFE{\mathit{G\mkern-4mu F\mkern-4.5mu E}}
\newcommand\Pa{\mathbf{Pa}}

% conversions
\newcommand{\WFGof}[1]{\Psi_{{#1}}}
\newcommand{\FGof}[1]{\Phi_{{#1}}}


%% DATABASE SYMBOLS
\newcommand{\D}{\mathbdcal D} % for a database
\newcommand{\Attrs}{\mathdcal A}
\newcommand{\Idx}{\mathcal J}
\newcommand{\Doms}{{\mathcal D}}
% \newcommand{\Rels}{{\mathcal R}}
\newcommand{\Rels}{{\mathbf R}}
\newcommand{\Cols}{\mathcal C}%{\sigma}
\newcommand{\Sch}{\mathdcal S}
\newcommand{\Keys}{\mathcal K}
\newcommand{\DBProb}{\mathdcal P}
\newcommand{\arity}{\mathit{ar}}

\newcommand\Varis{\V\kern-.65pt\mathit{ars}}%
\newcommand\Bmid{\mathrel{\Big|}}%
\newcommand\vals{\mathbf{vals}}
\newcommand\nj{\bowtie}

% before theorems I need this:
\def\structurelevels{part,section,subsection,subsubsection,paragraph}%	
\newcommand\nextstructurelevel{%
	\ifnum\value{section}=0 section\else%
	  \ifnum\value{subsection}=0 subsection\else%
	    \ifnum\value{subsubsection}=0 subsubsection\else%
		paragraph\fi\fi\fi}

%% The loop didn't work :( burrying it for now...
% \expandafter\newcommand\nextstructurelevel{%
% 	{\foreach\strl in \structurelevels{%
% 		\ifnum\expandafter\value{\strl}=0%
% 			\strl\breakforeach\fi%
% 		}%
% 	}}
% \newcommand\nextstructurelevel{subsubsection}

%% THEOREMS
\usepackage{amsthm}
\usepackage{thmtools} % asmsymb must be loaded also.
\usepackage[framemethod=TikZ]{mdframed}

	\makeatletter\begingroup
	
	\@for\theoremstyle:=definition,remark,plain\do{%
			\expandafter\g@addto@macro\csname th@\theoremstyle\endcsname{%
				\addtolength\thm@preskip\parskip}
			}\endgroup
	% add theorems, examples,etc to table of contents
	\def\thmTOCadd{
		\edef\asdffdsa{\nextstructurelevel}
		\ifx\thmt@optarg\@empty
			\addcontentsline{toc}{\asdffdsa}{%
			\texorpdfstring{
			 	\makebox[3cm][r]{\color{gray}{\it\thmt@thmname}~%
				\csname the\thmt@envname\endcsname}}%
			{\thmt@thmname\csname the\thmt@envname\endcsname: \thmt@optarg}}
		\else\addcontentsline{toc}{\asdffdsa}{%
			\texorpdfstring{
			 	\makebox[3cm][r]{\color{gray}{\it\thmt@thmname}~%
				\csname the\thmt@envname\endcsname:}\hspace{1em} {\color{black!50!gray}\small\thmt@optarg}}%
			{\thmt@thmname\csname the\thmt@envname\endcsname: \thmt@optarg} %
		}\fi}
	% macro for clearing theorems (if preamble adapted)
	% my answer presented here: https://tex.stackexchange.com/a/296184/191268
	\def\cleartheorem#1{%
		\expandafter\let\csname#1\endcsname\relax
		\expandafter\let\csname c@#1\endcsname\relax
	}
	\def\clearthms#1{ \@for\tname:=#1\do{\cleartheorem\tname} }
	\makeatother

	\theoremstyle{plain}
	\declaretheorem[within=section,name=Theorem,postheadhook={\thmTOCadd}]{theorem}
	\newtheorem{coro}{Corollary}[theorem]
	\declaretheorem[sibling=theorem,name=Proposition, postheadhook={\thmTOCadd}]{prop}
	\newtheorem{lemma}[theorem]{Lemma}
	\newtheorem{fact}[theorem]{Fact}
	\newtheorem{conj}[theorem]{Conjecture}

	\theoremstyle{definition}
	\newtheorem*{defn*}{Definition}
	\declaretheorem[name=Definition,style=definition,qed=$\square$,within=section, postheadhook={\thmTOCadd}]{defn}
	\declaretheorem[name=Construction,qed=$\square$,sibling=defn, postheadhook={\thmTOCadd}]{constr}
	% \declaretheorem[qed=$\square$]{example}
	\declaretheorem[name=Example,qed=$\square$,postheadhook={\thmTOCadd}]{example}

	\theoremstyle{remark}
	\newtheorem*{remark}{Remark}

	\usepackage{xpatch}
	\makeatletter
	\xpatchcmd{\thmt@restatable}% Edit \thmt@restatable
	   {\csname #2\@xa\endcsname\ifx\@nx#1\@nx\else[{#1}]\fi}% Replace this code
	   % {\ifthmt@thisistheone\csname #2\@xa\endcsname\typeout{oiii[#1;#2\@xa;#3;\csname thmt@stored@#3\endcsname]}\ifx\@nx#1\@nx\else[#1]\fi\else\csname #2\@xa\endcsname\fi}% with this code
	   {\ifthmt@thisistheone\csname #2\@xa\endcsname\ifx\@nx#1\@nx\else[{#1}]\fi
	   \else\fi}
	   {}{\typeout{THMT PATCH FAILURE; recall may not work}} % execute code for success/failure instances
	\xpatchcmd{\thmt@restatable}% Edit \thmt@restatable
	   {\csname end#2\endcsname}
	   {\ifthmt@thisistheone\csname end#2\endcsname\else\fi}
	   {}{\typeout{THMT PATCH FAILURE; recall may not work}}
	%% version of \recall used in PDG.tex
	% \newcommand{\recall}[1]{\medskip\par\noindent{\bf \expandarg\Cref{thmt@@#1}.}
	%  	\begingroup\em \noindent \expandafter\csname#1\endcsname* \endgroup\par\smallskip}
	%% old version of \recall with quotations
	% \newcommand\recall[1]{\expandarg\cref{#1}:\vspace{-1em} \begingroup\small\color{gray!80!black}\begin{quotation} \expandafter\csname #1\endcsname* \end{quotation}\endgroup }
	%% a hybrid:
	\newcommand{\recall}[1]{\medskip\par
	\begingroup\small\color{gray!20!black}\begin{quotation}
		\noindent{\bf \expandarg\Cref{thmt@@#1}:}
	 	\begingroup\em \noindent \expandafter\csname#1\endcsname* \endgroup
	\end{quotation}\endgroup
	\par\smallskip}
	\makeatother

	\newcommand{\begthm}[3][]{\begin{#2}[{name=#1},restate=#3,label=#3]}

%% ANNOTATION
\newcommand{\todo}[1]{{\color{red}\ \!\Large\smash{\textbf{[}}{\normalsize\textsc{todo:} #1}\ \!\smash{\textbf{]}}}}
\newcommand{\note}[1]{{\color{blue}\ \!\Large\smash{\textbf{[}}{\normalsize\textsc{note:} #1}\ \!\smash{\textbf{]}}}}
\newcommand{\moveme}[1]{{\color{purple}\ \!\Large\smash{\textbf{[}}{\normalsize\textsc{moveme:} #1}\ \!\smash{\textbf{]}}}}

\mdfdefinestyle{mybox}{skipabove=1em,skipbelow=1em,roundcorner=2pt}
\newmdenv[style=mybox,fontcolor=black!25, backgroundcolor=black!3,linecolor=black!20]{inactive}
\newmdenv[style=mybox,backgroundcolor=color3!5,linecolor=color3!20]{highlight-changes}
\newmdenv[style=mybox,linecolor=color2!50,topline=false,bottomline=false,rightline=false,innerleftmargin=1em,linewidth=5pt]{leftbar}
\newmdenv[roundcorner=5pt, subtitlebelowline=true,subtitleaboveline=true, subtitlebackgroundcolor=color1!70!white,
 	backgroundcolor=color3!20!white, frametitle={Annotating},frametitlerule=true, frametitlebackgroundcolor=color1!70!white, skipabove=1em,skipbelow=1em,]{annotating}
\newmdenv[roundcorner=5pt, backgroundcolor=pinkish!20!white, frametitle={$\langle$under construction $\rangle$},frametitlerule=false,
innertopmargin=2pt, frametitlebelowskip=3pt, frametitleaboveskip=2pt, frametitlebackgroundcolor=pinkish!70!white, skipabove=1em,skipbelow=1em, frametitlefont={\normalfont\itshape},leftmargin=-10pt, rightmargin=-10pt]
		{wip}
% \usetikzlibrary{external}
% \tikzexternalize[prefix=tikz/]  % activate!
% \usepackage{etoolbox}
% \AtBeginEnvironment{tikzcd}{\tikzexternaldisable} %... except careful of tikzcd...
% \AtEndEnvironment{tikzcd}{\tikzexternalenable}


%%%%%%%%%%%%%%%% TIKZ SETUP %%%%%%%%%%%%%%%%%%%%%
	\usetikzlibrary{positioning,fit,calc, decorations, arrows, shapes, shapes.geometric}
	\usetikzlibrary{patterns,backgrounds}
	\usetikzlibrary{cd}
	
	\pgfdeclaredecoration{arrows}{draw}{
		\state{draw}[width=\pgfdecoratedinputsegmentlength]{%
			\path [every arrow subpath/.try] \pgfextra{%
				\pgfpathmoveto{\pgfpointdecoratedinputsegmentfirst}%
				\pgfpathlineto{\pgfpointdecoratedinputsegmentlast}%
			};
	}}
	%%%%%%%%%%%%
	\tikzset{AmpRep/.style={ampersand replacement=\&}}
	\tikzset{center base/.style={baseline={([yshift=-.8ex]current bounding box.center)}}}
	\tikzset{paperfig/.style={center base,scale=1.0, every node/.style={transform shape}}}

	\tikzset{is bn/.style={background rectangle/.style={fill=blue!35,opacity=0.3, rounded corners=5},show background rectangle}}
	% Node Stylings
	\tikzset{dpadded/.style={rounded corners=2, inner sep=0.7em, draw, outer sep=0.3em, fill={black!50}, fill opacity=0.08, text opacity=1}}
	% \tikzset{active/.style={fill=blue, fill opacity=0.1}}
	% \tikzset{square/.style={regular polygon,regular polygon sides=4, rounded corners = 0}}
	% \tikzset{octagon/.style={regular polygon,regular polygon sides=8, rounded corners = 0}}
	\tikzset{dpad0/.style={outer sep=0.05em, inner sep=0.3em, draw=gray!75, rounded corners=4, fill=black!08, fill opacity=1}}
	\tikzset{dpad1/.style={outer sep=0.1em, inner sep=0.4em, draw=gray!75, rounded corners=3, fill=black!08, fill opacity=1}}
	\tikzset{dpad/.style args={#1}{every matrix/.append style={nodes={dpadded, #1}}}}
	\tikzset{light pad/.style={outer sep=0.2em, inner sep=0.5em, draw=gray!50}}
		
	\tikzset{arr/.style={draw, ->, thick, shorten <=3pt, shorten >=3pt}}
	\tikzset{arr0/.style={draw, ->, thick, shorten <=0pt, shorten >=0pt}}
	\tikzset{arr1/.style={draw, ->, thick, shorten <=1pt, shorten >=1pt}}
	\tikzset{arr2/.style={draw, ->, thick, shorten <=2pt, shorten >=2pt}}
	\tikzset{archain/.style args={#1}{arr, every arrow subpath/.style={draw,arr, #1}, decoration=arrows, decorate}}


	\tikzset{fgnode/.style={dpadded,inner sep=0.6em, circle},
	factor/.style={light pad, fill=black}}	
	
	% For illustrating what's inside of nodes:
	\tikzset{alternative/.style args={#1|#2|#3}{name=#1, circle, fill, inner sep=1pt,label={[name={lab-#1},gray!30!black]#3:\scriptsize #2}} }
	
	\tikzset{bpt/.style args={#1|#2}{alternative={#1|#2|above}} }
	\tikzset{tpt/.style args={#1|#2}{alternative={#1|#2|below}} }
	\tikzset{lpt/.style args={#1|#2}{alternative={#1|#2|left}} }
	\tikzset{rpt/.style args={#1|#2}{alternative={#1|#2|right}} }
	\tikzset{pt/.style args={#1}{alternative={#1|#1|above}} }
	\tikzset{mpt/.style args={#1|#2}{name=#1, circle, fill, inner sep=1pt,label={[name={lab-#1},gray]\scriptsize #2}} }
	
	\tikzset{Dom/.style args={#1 (#2) around #3}{dpadded, name=#2, label={[name={lab-#2},align=center] #1}, fit={ #3 } }}
	\tikzset{bDom/.style args={#1 (#2) around #3}{dpadded, name=#2, label={[name={lab-#2},align=center]below:#1}, fit={ #3 } }}
	
	
	\newcommand\cmergearr[4]{
		\draw[arr,-] (#1) -- (#4) -- (#2);
		\draw[arr, shorten <=0] (#4) -- (#3);
	}
	\newcommand\mergearr[3]{
		\coordinate (center-#1#2#3) at (barycentric cs:#1=1,#2=1,#3=1.2);
		\cmergearr{#1}{#2}{#3}{center-#1#2#3}
	}
	\newcommand\cunmergearr[4]{
		\draw[arr,-, , shorten >=0] (#1) -- (#4);
		\draw[arr, shorten <=0] (#4) -- (#2);
		\draw[arr, shorten <=0] (#4) -- (#3);
	}
	\newcommand\unmergearr[3]{
		\coordinate (center-#1#2#3) at (barycentric cs:#1=1.2,#2=1,#3=1);
		\cunmergearr{#1}{#2}{#3}{center-#1#2#3}
	}

	
	\usetikzlibrary{matrix}
	\tikzset{toprule/.style={%
	        execute at end cell={%
	            \draw [line cap=rect,#1] 
	            (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.north west) -- (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.north east);%
	        }
	    },
	    bottomrule/.style={%
	        execute at end cell={%
	            \draw [line cap=rect,#1] (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south west) -- (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south east);%
	        }
	    },
	    leftrule/.style={%
	        execute at end cell={%
	            \draw [line cap=rect,#1] (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.north west) -- (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south west);%
	        }
	    },
	    rightrule/.style={%
	        execute at end cell={%
	            \draw [line cap=rect,#1] (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.north east) -- (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south east);%
	        }
	    },
	    table with head/.style={
		    matrix of nodes,
		    row sep=-\pgflinewidth,
		    column sep=-\pgflinewidth,
		    nodes={rectangle,minimum width=2.5em, outer sep=0pt},
		    row 1/.style={toprule=thick, bottomrule},
  	    }
	}

	

% \NewEnviron{ctikzpicture}{\begin{center}\expandafter\begin{tikzpicture}\BODY\end{tikzpicture}\end{center}}
% \usetikzlibrary{shapes.geometric}
\usetikzlibrary{backgrounds}
\tikzset{dpad0/.style={outer sep=0.05em, inner sep=0.3em, draw=gray!75, rounded corners=4, fill=black!08, fill opacity=1}}
\tikzset{arr0/.style={draw, ->, thick, shorten <=0pt, shorten >=0pt}}
\tikzset{arr1/.style={draw, ->, thick, shorten <=1pt, shorten >=1pt}}
\tikzset{arr2/.style={draw, ->, thick, shorten <=2pt, shorten >=2pt}}
\tikzset{is bn/.style={background rectangle/.style={fill=blue!35,opacity=0.3, rounded corners=5},show background rectangle}}
\newcommand\lab[1]{(#1)(lab-#1)}


%%%%%%%%%%%%%% label_matrix.tex %%%%%%%%%%%%%%%%
\input{labelmatrix}
% should result in the following (which is not maintained)

% %OMG THIS WORKS
% \def\wrapwith#1[#2;#3]{
% 	\expandarg\IfSubStr{#1}{,}{
% 		\expandafter#2{\expandarg\StrBefore{#1}{,}}
% 		\expandarg\StrBehind{#1}{,}[\tmp] 
% 		\xdef\tmp{\expandafter\unexpanded\expandafter{\tmp}}
% 		#3
% 		\wrapwith{\tmp}[#2;{#3}]
% 	}{ \expandafter#2{#1} }
% }
% \def\hwrapcells#1[#2]{\wrapwith#1[#2;&]}
% \def\vwrapcells#1[#2]{\wrapwith#1[#2;\\]}
% 
% \newcommand{\smalltext}[1]{\text{\footnotesize#1}}
% \newsavebox{\idxmatsavebox}
% \def\makeinvisibleidxstyle#1#2{\phantom{\hbox{#1#2}}}
% \newenvironment{idxmatphant}[4][\color{gray}\smalltext]{%
% 	\def\idxstyle{#1}
% 	\def\colitems{#3}
% 	\def\rowitems{#2}
% 	\def\phantitems{#4}
% 	\begin{lrbox}{\idxmatsavebox}$
% 	\begin{matrix}  \begin{matrix} \hwrapcells{\colitems}[\idxstyle]  \end{matrix} \\[0.1em]
% 		\left[ 
% 		\begin{matrix}
% 			\hwrapcells{\phantitems}[\expandafter\makeinvisibleidxstyle\idxstyle]  \\[-1em]
% 	}{
% 		\end{matrix}\right]		&\hspace{-0.5em}\begin{matrix*}[l] \vwrapcells{\rowitems}[\idxstyle] \end{matrix*}
% 	\end{matrix}
% 	$\end{lrbox}
% 	\raisebox{0.75em}{\usebox\idxmatsavebox}
% %	\vspace{-0.5em}
% }
% 
% \newenvironment{idxmat}[3][\color{gray}\smalltext]
% 	{\begingroup\idxmatphant[#1]{#2}{#3}{#3}}
% 	{\endidxmatphant\endgroup}
% 
% \newenvironment{sqidxmat}[2][\color{gray}\smalltext]
% 	{\begingroup\idxmat[#1]{#2}{#2}}
% 	{\endidxmat\endgroup}
% 
